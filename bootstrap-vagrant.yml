---
- name: set up vagrant environment
  hosts: vagrant

  vars:
    user_home: /home/{{ ansible_user }}
    bootstrap_home: "{{ user_home }}/.bootstrap"
    dotfiles_home: "{{ user_home }}/.dotfiles"

  roles:
    - base
    - user-settings

  tasks:
    - name: link settings
      file:
        src: /vagrant/{{ item }}
        dest: /home/vagrant/{{ item }}
        state: link
        force: yes
      with_items:
        - .aliases.zsh
        - .zhistory
        - .ssh-agent.zsh

    - name: modify .localrc
      lineinfile:
        dest: /home/vagrant/.localrc
        line: "{{ item }}"
        create: yes
      with_items:
        - "for i in .*.zsh; do source $i; done"
