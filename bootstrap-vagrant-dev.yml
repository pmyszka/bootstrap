---
- import_playbook: bootstrap-vagrant.yml

- name: set up dev environment
  hosts: vagrant

  vars:
    user_home: /home/{{ ansible_user }}
    bootstrap_home: "{{ user_home }}/.bootstrap"
    dotfiles_home: "{{ user_home }}/.dotfiles"

  roles:
    - dev

- name: set up dev environment
  hosts: vagrant
  tasks:
    - name: create .m2
      file:
        path: /home/vagrant/.m2
        state: directory

    - name: link maven repo
      file:
        src: /vagrant/.opt/maven-repository
        dest: /home/vagrant/.m2/repository
        state: link
        force: yes

    - name: link ssh keys
      shell: for i in /vagrant/.ssh/*.prv; do ln -fs "$i" "/home/vagrant/.ssh/$(basename $i)"; done

    - name: list ssh keys for ssh-agent
      shell: echo -n > /home/vagrant/.ssh-agent.zsh; for i in /vagrant/.ssh/*.prv; do echo "ssh-add $i" >> /home/vagrant/.ssh-agent.zsh; done
